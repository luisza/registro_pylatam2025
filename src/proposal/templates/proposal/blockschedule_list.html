{% extends 'base.html' %}
{% load i18n %}
{% load bootstrap %}
{% load registro_charla %}
{% load static %}
{% block css %}
    <link href="{% static 'css/proposal.css' %}" rel="stylesheet">
{% endblock %}
{% block content %}
    <div id="info-page">
        <h2> Tem√°ticas </h2>
    </div>

    <div class="row">
        <div class="col-md-4" id="filterPanel">
            <h4> {% trans 'Speeches' %} </h4>
            <hr>
            <div class="card">
                <div class="card-body">
                    <div class="row flex">
                        <div class="col-md-6 inline-flex">
                            <div class="col-2">
                                <span class="input-group-btn">
                                    <a style="height: 40px;" data-toggle="modal"
                                       data-target="#topic-modal" class="btn btn-info add-button">
                                        <i class="fas fa-plus" style="margin-top: 15px"></i>
                                    </a>
                                </span>
                            </div>
                            <div class="col-10">
                                <form id="filter" method="post">
                                    {% csrf_token %}
                                    <select class="btn sidebar-select btn-primary" style="height: 40px" name="topic"
                                            id="topic">
                                        <option selected value="None">{% trans 'Topic' %}</option>
                                        {% for topic in topics %}
                                            <option value={{ topic.id }}>{{ topic }}</option>
                                        {% endfor %}
                                    </select>
                                </form>
                            </div>
                        </div>
                        <div class="col-md-6 inline-flex">
                            <div class="col-2">
                                <span class="input-group-btn">
                                    <a style="height: 40px" data-toggle="modal" data-target="#type-modal"
                                       class="btn btn-info add-button">
                                        <i style="margin-top: 15px" class="fas fa-plus"></i></a>
                                </span>
                            </div>
                            <div class="col-9">
                                <select class="btn sidebar-select btn-primary" style="height: 40px" name="type"
                                        id="type">
                                    <option selected value="None">{% trans 'Type' %}</option>
                                    {% for type in types %}
                                        <option time={{ type.time }} value={{ type.id }}>{{ type }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="col-1">
                                <a style="height: 40px" onclick="send_filter(0,0)" id="search"
                                   class="btn btn-info add-button">
                                    <i style="margin-top: 15px" class="fas fa-search"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                    <br>
                    <div class="jumbotron" id="draggable-events">
                        <ul id="speeches" class="connectedSortable droppable" hora="7:00:00">
                            {% for speech in speeches %}
                                <li id="li_{{ speech.pk }}" class="ui-state-default activity"
                                    style="background-color: {{ speech.topic.color }};"
                                    activity_pk="{{ speech.pk }}" color="{{ speech.topic.color }}"
                                    time="{{ speech.speech_type.time }}" is_speech="true" desc="none">
                                    <div class="row">
                                        <div class="col-sm-8 speech-text">
                                            {{ speech }}
                                        </div>
                                        <div class="col-sm-4 container_type_time_{{ speech.pk }}">
                                            <select selected="{{ speech.speech_type.id }}" style="width: 100%"
                                                    class="btn btn-primary selectType" id="type_time"
                                                    onchange="update_times({{ speech.pk }},this, {{ speech.speech_type.time }}, 0)">

                                                <option disabled> Asked Time {{ speech.speech_time_asked }} min</option>
                                                {% for type in types %}
                                                    {% if  type.id == speech.speech_type.id %}
                                                        <option selected
                                                                value="{{ type.time }}-{{ type.id }}">{{ type }}</option>

                                                    {% else %}
                                                        <option value="{{ type.time }}-{{ type.id }}">{{ type }}</option>
                                                    {% endif %}
                                                {% endfor %}
                                            </select>
                                        </div>
                                    </div>
                                </li>
                            {% endfor %}
                        </ul>
                    </div>
                    <br>
                    <div class="inline-flex">
                        <h4> {% trans 'Special Activities' %}</h4>
                        <div class="add-activity">
                            <a data-toggle="modal" data-target="#special-modal"
                               class="btn btn-info add-button pl-2"><i class="fas fa-plus"></i></a>
                        </div>
                    </div>
                    <hr>
                    <div class="jumbotron">
                        <ul id="specials" class="connectedSortable droppable" hora="7:00:00">
                            {% for special in specialActivity %}
                                <li class="ui-state-default activity" style="background-color: #cccccc;" color="#cccccc"
                                    time="{{ special.type.time }}" is_speech=""
                                    desc="{{ special.message }}"
                                    activity_pk="{{ special.pk }}">
                                    {{ special }} / {{ special.type.time }} min
                                </li>
                            {% endfor %}
                        </ul>
                    </div>

                    <div id="topic-modal" class="modal fade" role="dialog">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                    <h4 class="modal-title"> {% trans 'New Speech Topic' %} </h4>
                                </div>
                                <div class="modal-body" style="text-align: center">
                                    <form action="proposal/createTopic/" method="post">
                                        {% csrf_token %}
                                        <div class="jumbotron" style="display: inline-grid">
                                            {{ topicForm }}
                                            <hr>
                                            <input class="btn btn-info" type="submit" value="{% trans 'Save' %}">
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="type-modal" class="modal fade" role="dialog">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                    <h4 class="modal-title"> {% trans 'New Speech Type' %}</h4>
                                </div>
                                <div class="modal-body" style="text-align: center">
                                    <form action="proposal/createType/" method="post">
                                        {% csrf_token %}
                                        <div class="jumbotron" style="display: inline-grid">
                                            {{ typeForm }}
                                            <hr>
                                            <input class="btn btn-info" type="submit" value="{% trans 'Save' %}">
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="special-modal" class="modal fade" role="dialog">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                    <h4 class="modal-title">{% trans 'New Special Activity' %}</h4>
                                </div>
                                <div class="modal-body" style="text-align: center">
                                    <form action="proposal/createSpecial/" method="post">
                                        {% csrf_token %}
                                        <div class="jumbotron" style="display: inline-grid;">
                                            {{ specialForm }}
                                            <hr>
                                            <input class="btn btn-info" type="submit" value="{% trans 'Save' %}">
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-8" id="calendar-container" >
            <ul class="nav nav-tabs" id="myTab" role="tablist">
                {% for room in rooms_list %}
                    <li class="nav-item">
                        <a class="nav-item nav-link room-tab" id="calendar-{{forloop.counter}}-tab" data-toggle="tab" href="#calendar-{{forloop.counter}}" role="tab" aria-controls="calendar-{{forloop.counter}}" aria-selected="false">{{ room }}</a>
                    </li>
                {% endfor %}
                <li class="nav-item">
                    <a id="addroom" href="#" data-toggle="modal" data-target="#room_modal">{% trans 'Add' %}</a>
                </li>
            </ul>
            <div class="tab-content" id="calendarContent">
                {% for room in rooms_list %}
                    <div class="full-calendar tab-pane fade" id="calendar-{{forloop.counter}}" role="tabpanel" aria-labelledby="calendar-{{forloop.counter}}-tab" data-start_date="{{start_date}}" data-end_date="{{ end_date }}"></div>
                {% endfor %}
            </div>
        </div>
        <div class="modal fade" role="dialog" id="room_modal">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                        <h2 class="modal-title text-center">{% trans 'Create Room' %}</h2>
                    </div>
                    <div class="modal-body">
                        <form name="roomForm" action="proposal/createRoom/" method="post">
                            {% csrf_token %}
                            {{ room_form|bootstrap }}
                            <input name="form_id" value="roomForm" hidden>
                            <br>
                            <div class="form-group text-center">
                                <input type="submit" name="action" class="btn btn-primary" value="{% trans 'Save Room' %}">
                                <button type="button" class="btn btn-secondary"
                                        data-dismiss="modal">{% trans 'Close' %}</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}

{% block js %}
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <script src="https://cdn.jsdelivr.net/combine/npm/fullcalendar@5.10.1,npm/fullcalendar@5.10.1/locales-all.min.js,npm/fullcalendar@5.10.1/locales-all.min.js,npm/fullcalendar@5.10.1/main.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/combine/npm/fullcalendar@5.10.1/main.min.css,npm/fullcalendar@5.10.1/main.min.css">
    <script src="{% static 'js/Blockschedule_list.js' %}"></script>
{% endblock %}